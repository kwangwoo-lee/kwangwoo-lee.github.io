<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ì˜ì–´ ë‹¨ì–´ ì™¸ìš°ê¸° ì•±</title>
    <!-- Tailwind CSS CDN ë¡œë“œ -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Tone.js CDN ë¡œë“œ (ì‚¬ìš´ë“œ ìƒì„±ìš©) -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/tone/14.8.49/Tone.min.js"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    colors: {
                        'primary': '#4F46E5', // Indigo
                        'secondary': '#10B981', // Emerald
                        'accent': '#FBBF24', // Amber
                        'correct': '#10B981', // Green
                        'incorrect': '#EF4444', // Red
                    },
                    fontFamily: {
                        sans: ['Inter', 'sans-serif'],
                    }
                }
            }
        }
    </script>
    <style>
        /* ê¸°ë³¸ ë ˆì´ì•„ì›ƒ ìŠ¤íƒ€ì¼ ë° í°íŠ¸ */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #f0f4f8; /* ë°ì€ ë°°ê²½ */
            display: flex;
            justify-content: center;
            align-items: center;
            /* ìµœì†Œ ë†’ì´ë¥¼ 100vhë¡œ ì„¤ì •í•˜ì—¬ í™”ë©´ ì „ì²´ë¥¼ ì°¨ì§€í•˜ë„ë¡ í•©ë‹ˆë‹¤. */
            min-height: 100vh;
            padding: 8px; /* í™”ë©´ ê²½ê³„ì™€ì˜ ì—¬ë°±ì„ ì¤„ì—¬ ê³µê°„ í™•ë³´ */
        }
        /* ëª¨ë°”ì¼/íƒœë¸”ë¦¿ ë§ì¶¤ í¬ê¸°: í™”ë©´ ë†’ì´ë¥¼ ìµœëŒ€í•œ ì‚¬ìš© */
        #app-container {
            width: 100%;
            max-width: 480px; 
            /* í™”ë©´ ë†’ì´ë¥¼ ê±°ì˜ ì „ë¶€ ì‚¬ìš©í•˜ë„ë¡ ì„¤ì • (ìŠ¤í¬ë¡¤ ë°©ì§€ í•µì‹¬) */
            height: 98vh; 
            max-height: 900px; /* í° í™”ë©´ì—ì„œë„ ê³¼ë„í•˜ê²Œ ì»¤ì§€ì§€ ì•Šë„ë¡ ì œí•œ */
            background-color: white;
            border-radius: 2rem;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.25);
            overflow: hidden; /* ìŠ¤í¬ë¡¤ ë°©ì§€ */
            display: flex;
            flex-direction: column;
        }
        /* ë²„íŠ¼ í¬ê¸° ì¡°ì • (ê¸€ì ì‚¬ì´ì¦ˆ ì•½ê°„ ì¤„ì„) */
        .btn-large {
            padding: 0.6rem 1rem; /* íŒ¨ë”© ì¶•ì†Œ */
            font-size: 1.125rem; /* text-xl -> text-lg (1.125rem)ë¡œ ì¶•ì†Œ */
            font-weight: 700;
            border-radius: 0.75rem; /* ë‘¥ê·¼ ëª¨ì„œë¦¬ë„ ì•½ê°„ ì¶•ì†Œ */
            transition: transform 0.1s;
        }
        .btn-large:active {
            transform: scale(0.98);
        }
        /* í€´ì¦ˆ ë¬¸ì œ í…ìŠ¤íŠ¸ í¬ê¸° ì¶•ì†Œ */
        .question-text {
            font-size: 2.5rem; /* 4xl -> 2.5rem (ì•½ê°„ ë” ì‘ê²Œ) */
        }

        /* íƒ€ì´ë¨¸ ë°” ì• ë‹ˆë©”ì´ì…˜ */
        #timer-bar {
            height: 6px; /* íƒ€ì´ë¨¸ ë°” ë†’ì´ ì¶•ì†Œ */
            background-color: #EF4444; /* Red color for time pressure */
            transition: width linear;
        }
        
        /* ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ (ë²„íŠ¼ì´ ë§ì„ ê²½ìš° ìŠ¤í¬ë¡¤ í—ˆìš©) */
        #content-area {
            flex-grow: 1;
            padding: 1rem 1.5rem; /* íŒ¨ë”© ì¡°ì • */
            display: flex;
            flex-direction: column;
            overflow-y: auto; /* ì˜¤ë‹µë…¸íŠ¸ê°€ ê¸¸ì–´ì§ˆ ê²½ìš° ëŒ€ë¹„ */
        }
        /* ì„ íƒì§€ ì˜ì—­ì—ì„œ ë²„íŠ¼ ê°„ì˜ ê°„ê²© ì¡°ì • */
        .option-button-container {
            flex-grow: 1;
            display: flex;
            flex-direction: column;
            justify-evenly;
            gap: 0.5rem; /* ë²„íŠ¼ ê°„ ê°„ê²© ì¶”ê°€ */
            min-height: 200px; /* ë²„íŠ¼ ì˜ì—­ ìµœì†Œ ë†’ì´ í™•ë³´ */
        }

    </style>
</head>
<body>

<div id="app-container">
    <!-- í—¤ë” ì˜ì—­ -->
    <header class="p-4 bg-primary text-white shadow-lg flex justify-between items-center rounded-t-[2rem]">
        <h1 class="text-xl font-black tracking-wider">ë‹¨ì–´ ë§ˆìŠ¤í„° ğŸš€</h1>
        <div id="score-display" class="bg-white text-primary px-3 py-1 rounded-full font-bold text-base shadow-md">
            ì ìˆ˜: 0ì 
        </div>
    </header>

    <!-- ë©”ì¸ ì½˜í…ì¸  ì˜ì—­ -->
    <main id="content-area">
        <!-- ì½˜í…ì¸ ê°€ ì—¬ê¸°ì— ë Œë”ë§ë©ë‹ˆë‹¤ (í™ˆ, í€´ì¦ˆ, ì˜¤ë‹µ ë…¸íŠ¸) -->
    </main>

    <!-- í”¼ë“œë°± ëª¨ë‹¬ (ìˆ¨ê¹€ ìƒíƒœ) -->
    <div id="feedback-modal" class="hidden fixed inset-0 bg-black bg-opacity-50 flex justify-center items-center p-4 z-50 transition-opacity duration-300">
        <div id="feedback-card" class="bg-white p-6 rounded-2xl w-full max-w-sm text-center shadow-2xl transform scale-95 opacity-0 transition-all duration-300">
            <!-- ëª¨ë‹¬ ì½˜í…ì¸ ëŠ” JSì—ì„œ ë™ì ìœ¼ë¡œ ì±„ì›Œì§‘ë‹ˆë‹¤ -->
        </div>
    </div>
</div>

<script>
    // ============== ì „ì—­ ë³€ìˆ˜ ë° ìƒìˆ˜ ==============
    const STORAGE_KEY = 'vocabularyAppScore';
    const QUIZ_OPTIONS_COUNT = 4;
    // ì´ 30ìŒ * 2ë¬¸ì œ = 60ë¬¸ì œ, ìµœëŒ€ ì ìˆ˜ 600ì 
    const MAX_SCORE = 600; 
    const TIME_LIMIT_SECONDS = 15; // íƒ€ì´ë¨¸ ì‹œê°„ ì œí•œ (15ì´ˆ)

    // ì‚¬ìš©ì ì œê³µ ë‹¨ì–´ ìŒ (30ê°œ) - ì—…ë°ì´íŠ¸ëœ ëª©ë¡
    const VOCAB = [
        { korean: "ê°€ì „ì œí’ˆ", english: "appliance" },
        { korean: "ë©ì–´ë¦¬", english: "block" },
        { korean: "ë²„ë„ˆ, ê°€ì—´ ê¸°êµ¬", english: "burner" },
        { korean: "ìš”ë¦¬", english: "cooking" },
        { korean: "ë–¨ì–´ëœ¨ë¦¬ë‹¤", english: "drop" },
        { korean: "ì†Œë¦¬ì¹˜ë‹¤", english: "exclaim" },
        { korean: "ëˆˆì¹", english: "eyebrow" },
        { korean: "ì•Œì•„ë‚´ë‹¤", english: "figure out" },
        { korean: "ë§ˆì¹¨ë‚´", english: "finally" },
        { korean: "ë–  ìˆë‹¤", english: "float" },
        { korean: "ì‹ ì„ í•œ", english: "fresh" },
        { korean: "ëƒ‰ì¥ê³ ", english: "fridge" },
        { korean: "ì–¼êµ´ì„ ì°Œí‘¸ë¦¬ë‹¤", english: "frown" },
        { korean: "ê¸°ê¸°, ì¥ì¹˜", english: "gadget" },
        { korean: "ì ¤", english: "gel" },
        { korean: "ë¹›ë‚˜ë‹¤", english: "glow" },
        { korean: "(ë¬´ì—‡ìœ¼ë¡œë„ ëŒ€ì²´í•  ìˆ˜ ì—†ì´) íŠ¹ë³„í•œ", english: "irreplaceable" },
        { korean: "ëƒ„ìƒˆê°€ ì—†ëŠ”", english: "odorless" },
        { korean: "(ì‚¬ê°í˜• ëª¨ì–‘ì˜) íŒ", english: "panel" },
        { korean: "ì†¥", english: "pot" },
        { korean: "êº¼ë‚´ë‹¤", english: "pull out" },
        { korean: "ì§ì‚¬ê°í˜•ì˜", english: "rectangular" },
        { korean: "ë‚˜ë¨¸ì§€", english: "rest" },
        { korean: "ë“œëŸ¬ë‚´ë‹¤", english: "reveal" },
        { korean: "ì„ ë°˜", english: "shelf" },
        { korean: "ì§€ê¸€ì§€ê¸€í•˜ëŠ” ì†Œë¦¬ë¥¼ ë‚´ë‹¤", english: "sizzle" },
        { korean: "ë¯¸ë„ëŸ¬ì§€ë“¯ì´ ì›€ì§ì´ë‹¤", english: "slide" },
        { korean: "ëƒ„ìƒˆ", english: "smell" },
        { korean: "ë–¨ì–´ì ¸ ìˆë‹¤", english: "stay away" },
        { korean: "ê³§ë°”ë¡œ", english: "straight" },
    ];

    // ============== ì•± ìƒíƒœ ê´€ë¦¬ ==============
    let score = 0;
    let currentScreen = 'home';
    let currentQuiz = null;
    let quizActive = false; 
    
    // íƒ€ì´ë¨¸ ê´€ë ¨ ë³€ìˆ˜
    let timerInterval = null;
    let timeLeft = TIME_LIMIT_SECONDS;
    
    // ì „ì²´ 60ë¬¸ì œ(30 KOR->ENG, 30 ENG->KOR)ë¡œ êµ¬ì„±ëœ ê³ ì • ë°°ì—´
    let quizCycle = []; 
    // í˜„ì¬ í€´ì¦ˆ ì§„í–‰ ì¸ë±ìŠ¤ (0ë¶€í„° ì‹œì‘)
    let currentQuizIndex = -1; 
    // í‹€ë¦° ë¬¸ì œì˜ ë‹¨ì–´ ìŒì„ ì €ì¥í•˜ëŠ” ë°°ì—´
    let incorrectlyAnswered = []; 

    // DOM ìš”ì†Œ ìºì‹œ
    const scoreDisplay = document.getElementById('score-display');
    const contentArea = document.getElementById('content-area');
    const feedbackModal = document.getElementById('feedback-modal');
    const feedbackCard = document.getElementById('feedback-card');
    
    // Tone.js Synth ì„¤ì •
    let synth;
    let tickSynth; // ê¸´ê¸‰ ì‚¬ìš´ë“œìš© ì‹ ë””ì‚¬ì´ì €
    let tickLoop; // ê¸´ê¸‰ ì‚¬ìš´ë“œ ë°˜ë³µ ë£¨í”„
    let isUrgentSoundPlaying = false; // ê¸´ê¸‰ ì‚¬ìš´ë“œ ì¬ìƒ ìƒíƒœ í”Œë˜ê·¸

    // ============== ì‚¬ìš´ë“œ ë¡œì§ ==============

    // Tone.js ì´ˆê¸°í™” ë° ì‚¬ìš´ë“œ ì„¤ì •
    function initAudio() {
        // 1. ì •ë‹µ/ì˜¤ë‹µ ì‚¬ìš´ë“œìš© PolySynth
        synth = new Tone.PolySynth(Tone.Synth, {
            oscillator: { type: "sine" },
            envelope: {
                attack: 0.005,
                decay: 0.1,
                sustain: 0.05,
                release: 0.5,
            }
        }).toDestination();
        
        // 2. ê¸´ê¸‰ ì¬ì´‰ ì‚¬ìš´ë“œìš© MembraneSynth (ì§§ê³  í†¡í†¡ íŠ€ëŠ” ì†Œë¦¬)
        tickSynth = new Tone.MembraneSynth({
            pitchDecay: 0.008,
            envelope: {
                attack: 0.001,
                decay: 0.1,
                sustain: 0.01,
                release: 0.05
            }
        }).toDestination();

        // 3. ê¸´ê¸‰ ì‚¬ìš´ë“œ ë£¨í”„ ì„¤ì • (8ë¶„ìŒí‘œ ê°„ê²© = 1ì´ˆì— 4ë²ˆ)
        tickLoop = new Tone.Loop(time => {
            tickSynth.triggerAttackRelease("C4", "32n", time, 0.5); // Fast, sharp tick
        }, "8n");
        // ë£¨í”„ëŠ” ì‹œì‘ ì‹œì ì— Tone.Transportì™€ í•¨ê»˜ ì‹œì‘ë©ë‹ˆë‹¤.
    }
    
    // ì •ë‹µ ì‚¬ìš´ë“œ ì¬ìƒ (ê²½ì¾Œí•œ í†¤)
    async function playCorrectSound() {
        if (Tone.context.state !== 'running') {
            await Tone.start();
        }
        // ì§§ê³  ê²½ì¾Œí•œ ìƒìŠ¹ ì•„ë¥´í˜ì§€ì˜¤ (C4, E4, G4)
        synth.triggerAttackRelease(["C4", "E4", "G4"], "8n");
    }

    // ì˜¤ë‹µ ë˜ëŠ” ì‹œê°„ ì´ˆê³¼ ì‚¬ìš´ë“œ ì¬ìƒ (ë‚®ê³  ë¶ˆí˜‘í™”ìŒì ì¸ í†¤)
    async function playIncorrectSound() {
        if (Tone.context.state !== 'running') {
            await Tone.start();
        }
        // ì§§ê³  ë¶ˆí˜‘í™”ìŒì ì¸ í•˜ê°• ì½”ë“œ (C#3, C3)
        synth.triggerAttackRelease(["C#3", "C3"], "16n"); 
    }

    // ============== íƒ€ì´ë¨¸ ë¡œì§ ==============

    function startTimer() {
        // ê¸°ì¡´ íƒ€ì´ë¨¸ í´ë¦¬ì–´
        clearInterval(timerInterval);
        // ì‹œê°„ ë° ìƒíƒœ ì´ˆê¸°í™”
        timeLeft = TIME_LIMIT_SECONDS;
        quizActive = true; 
        
        // íƒ€ì´ë¨¸ ë°” ì´ˆê¸°í™” ë° ì• ë‹ˆë©”ì´ì…˜ ì„¤ì •
        const timerBar = document.getElementById('timer-bar');
        if (timerBar) {
            timerBar.style.width = '100%';
            // CSS transitionì„ ì‚¬ìš©í•˜ì—¬ 15ì´ˆ ë™ì•ˆ ë„ˆë¹„ 0%ë¡œ ì• ë‹ˆë©”ì´ì…˜
            timerBar.style.transitionDuration = `${TIME_LIMIT_SECONDS}s`;
            // ê°•ì œë¡œ ë¦¬í”Œë¡œìš°ë¥¼ ë°œìƒì‹œì¼œ ì´ˆê¸° ìƒíƒœ (100%) ì ìš©
            void timerBar.offsetWidth; 
            // 10ms í›„ ì• ë‹ˆë©”ì´ì…˜ ì‹œì‘ (15ì´ˆ ë™ì•ˆ 0%ë¡œ)
            setTimeout(() => {
                timerBar.style.width = '0%';
            }, 10);
        }
        
        // 1ì´ˆë§ˆë‹¤ ì‹œê°„ ì—…ë°ì´íŠ¸ ë° ì²´í¬
        timerInterval = setInterval(() => {
            if (timeLeft >= 0) { // 0ì´ˆì¼ ë•Œë„ ë§ˆì§€ë§‰ ì—…ë°ì´íŠ¸ë¥¼ ìœ„í•´ ì‹¤í–‰
                updateTimerDisplay();
                if (timeLeft > 0) {
                    timeLeft--;
                } else {
                    // ì‹œê°„ ì´ˆê³¼ ì²˜ë¦¬
                    clearInterval(timerInterval);
                    timeExpired();
                }
            }
        }, 1000);
    }
    
    function stopTimer() {
        clearInterval(timerInterval);
        quizActive = false;
        
        // ê¸´ê¸‰ ì‚¬ìš´ë“œ ë£¨í”„ ì¤‘ì§€
        if (isUrgentSoundPlaying) {
            tickLoop.stop();
            Tone.Transport.stop(); // Tone.Loopë¥¼ ì‚¬ìš©í–ˆìœ¼ë¯€ë¡œ Transportë„ ì¤‘ì§€
            isUrgentSoundPlaying = false;
        }

        // ì• ë‹ˆë©”ì´ì…˜ ì¤‘ë‹¨ (íƒ€ì´ë¨¸ ë°” ì´ˆê¸°í™”)
        const timerBar = document.getElementById('timer-bar');
        if (timerBar) {
            timerBar.style.transitionDuration = '0s'; // ì• ë‹ˆë©”ì´ì…˜ ì¤‘ë‹¨
            timerBar.style.width = '100%'; // ì´ˆê¸° ìƒíƒœë¡œ ë³µêµ¬
        }
    }
    
    function updateTimerDisplay() {
        const timerDisplay = document.getElementById('timer-display');
        if (timerDisplay) {
            timerDisplay.textContent = `ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ`;
            
            // ============== NEW URGENT SOUND & VISUAL LOGIC ==============
            if (timeLeft > 0 && timeLeft <= 5) {
                // 1. ê¸´ê¸‰ ì‚¬ìš´ë“œ ì‹œì‘
                if (!isUrgentSoundPlaying) {
                    // AudioContextê°€ ì ê²¨ìˆì„ ê²½ìš° í•´ì œ
                    if (Tone.context.state !== 'running') {
                        Tone.start(); 
                    }
                    tickLoop.start(0);
                    Tone.Transport.start(); // Tone.Loopë¥¼ ì‹œì‘í•˜ë ¤ë©´ Transportë„ ì‹œì‘í•´ì•¼ í•¨
                    isUrgentSoundPlaying = true;
                }
                
                // 2. ê¸´ë°•ê° ìˆëŠ” í…ìŠ¤íŠ¸ ìƒ‰ìƒ ì ìš©
                timerDisplay.classList.remove('text-gray-700');
                timerDisplay.classList.add('text-incorrect', 'font-bold');
            } else {
                // 1. ê¸´ê¸‰ ì‚¬ìš´ë“œ ì¤‘ì§€
                if (isUrgentSoundPlaying) {
                    tickLoop.stop();
                    Tone.Transport.stop(); 
                    isUrgentSoundPlaying = false;
                }
                
                // 2. ì¼ë°˜ í…ìŠ¤íŠ¸ ìƒ‰ìƒ ì ìš©
                timerDisplay.classList.remove('text-incorrect', 'font-bold');
                timerDisplay.classList.add('text-gray-700');
            }
        }
    }
    
    // ì‹œê°„ ì´ˆê³¼ ì‹œ í˜¸ì¶œë˜ëŠ” í•¨ìˆ˜
    function timeExpired() {
        if (!currentQuiz) return;
        
        // í€´ì¦ˆ ì‘ë‹µì„ 'ì‹œê°„ ì´ˆê³¼'ë¡œ ê°„ì£¼í•˜ì—¬ ì˜¤ë‹µ ì²˜ë¦¬
        stopTimer(); // ì´ í•¨ìˆ˜ ë‚´ì—ì„œ ê¸´ê¸‰ ì‚¬ìš´ë“œë„ ì¤‘ì§€ë¨
        playIncorrectSound(); // ì˜¤ë‹µ ì‚¬ìš´ë“œ ì¬ìƒ
        
        // ì˜¤ë‹µ ê¸°ë¡
        recordIncorrectAnswer(currentQuiz.wordPair);
        
        // ì‹œê°„ ì´ˆê³¼ í”¼ë“œë°± ëª¨ë‹¬ í‘œì‹œ
        showFeedback(false, true); 
    }

    // ì˜¤ë‹µ ê¸°ë¡ í—¬í¼ í•¨ìˆ˜
    function recordIncorrectAnswer(wordPair) {
        const isAlreadyLogged = incorrectlyAnswered.some(pair => 
            pair.english === wordPair.english && pair.korean === wordPair.korean
        );
        if (!isAlreadyLogged) {
            incorrectlyAnswered.push(wordPair);
        }
    }

    // ============== ì´ˆê¸°í™” ë° ë°ì´í„° ë¡œë“œ ==============
    function loadScore() {
        const savedScore = localStorage.getItem(STORAGE_KEY);
        if (savedScore !== null) {
            score = parseInt(savedScore, 10);
        }
    }
    
    function saveScore() {
        localStorage.setItem(STORAGE_KEY, score.toString());
    }

    function initApp() {
        console.log("ì•± ì´ˆê¸°í™” ì¤‘...");
        loadScore();
        initAudio(); // ì˜¤ë””ì˜¤ ì´ˆê¸°í™”
        // ì•± ì‹œì‘ ì‹œ í€´ì¦ˆ ì‚¬ì´í´ ì´ˆê¸°í™”
        resetQuizCycle(); 
        render();
    }

    // ============== í€´ì¦ˆ ì‚¬ì´í´ ìƒì„± ë¡œì§ ==============

    // Helper: ë‹¨ì¼ í€´ì¦ˆ ê°ì²´ ìƒì„±
    function generateSingleQuiz(correctAnswerData, isEngToKor) {
        // ì •ë‹µì„ ì œì™¸í•œ ë‚˜ë¨¸ì§€ ë‹¨ì–´ë“¤
        const distractors = [...VOCAB].filter(word => word.english !== correctAnswerData.english);
        const optionsData = [correctAnswerData];
        
        // í•„ìš”í•œ ì˜¤ë‹µ ìˆ˜ë§Œí¼ ëœë¤í•˜ê²Œ ì¶”ì¶œ
        const numDistractorsNeeded = Math.min(QUIZ_OPTIONS_COUNT - 1, distractors.length);
        const shuffledDistractors = distractors.sort(() => 0.5 - Math.random()).slice(0, numDistractorsNeeded);
        
        // ìµœì¢… ì„ íƒì§€ ë°ì´í„° (ì •ë‹µ í¬í•¨)ë¥¼ ë‹¤ì‹œ ì„ìŒ
        const finalOptionsData = optionsData.concat(shuffledDistractors).sort(() => 0.5 - Math.random());

        let question, answer, options, quizTypeLabel;

        if (isEngToKor) {
            // ENG -> KOR
            question = correctAnswerData.english;
            answer = correctAnswerData.korean;
            options = finalOptionsData.map(w => w.korean);
            quizTypeLabel = 'ì˜ì–´ ë³´ê³  í•œê¸€ ë²ˆì—­ ì°¾ê¸° (ENG â†’ KOR)';
        } else {
            // KOR -> ENG
            question = correctAnswerData.korean;
            answer = correctAnswerData.english;
            options = finalOptionsData.map(w => w.english);
            quizTypeLabel = 'í•œê¸€ ë³´ê³  ì˜ì–´ ë‹¨ì–´ ì°¾ê¸° (KOR â†’ ENG)';
        }

        return {
            type: isEngToKor ? 'eng-kor' : 'kor-eng',
            question: question,
            answer: answer,
            options: options,
            label: quizTypeLabel,
            // ì˜¤ë‹µ ë…¸íŠ¸ì— ê¸°ë¡í•  ì›ë³¸ ë‹¨ì–´ ìŒ
            wordPair: { korean: correctAnswerData.korean, english: correctAnswerData.english }
        };
    }

    // ì „ì²´ ë¬¸ì œ ìˆ˜ ê³ ì • ì‚¬ì´í´ ìƒì„± ë° ìƒíƒœ ì´ˆê¸°í™”
    function resetQuizCycle() {
        // 1. KOR -> ENG í€´ì¦ˆ ìƒì„±
        const korToEngQuizzes = VOCAB.map(correctWordData => generateSingleQuiz(correctWordData, false));
        // 2. ENG -> KOR í€´ì¦ˆ ìƒì„±
        const engToKorQuizzes = VOCAB.map(correctWordData => generateSingleQuiz(correctWordData, true));

        // 3. ë¬¸ì œ ê²°í•© ë° ë¬´ì‘ìœ„ ì„ê¸°
        quizCycle = [...korToEngQuizzes, ...engToKorQuizzes];
        quizCycle.sort(() => 0.5 - Math.random()); 
        
        // ìƒíƒœ ì´ˆê¸°í™”
        incorrectlyAnswered = [];
        currentQuizIndex = -1;
        
        console.log(`ìƒˆë¡œìš´ í€´ì¦ˆ ì‚¬ì´í´ ìƒì„±: ${quizCycle.length}ë¬¸ì œ`);
    }

    // ============== í™”ë©´ ë Œë”ë§ í•¨ìˆ˜ ==============

    function updateScoreDisplay() {
        scoreDisplay.textContent = `ì ìˆ˜: ${score}ì `;
    }

    function render() {
        // í™”ë©´ ì „í™˜ ì‹œ íƒ€ì´ë¨¸ ì •ì§€ (stopTimerì—ì„œ ê¸´ê¸‰ ì‚¬ìš´ë“œë„ ì¤‘ì§€ë¨)
        stopTimer(); 
        
        updateScoreDisplay();
        contentArea.innerHTML = ''; // ì½˜í…ì¸  ì˜ì—­ ì´ˆê¸°í™”

        if (currentScreen === 'home') {
            renderHomeScreen();
        } else if (currentScreen === 'quiz') {
            renderQuizScreen();
            // í€´ì¦ˆ í™”ë©´ ë Œë”ë§ í›„ íƒ€ì´ë¨¸ ì‹œì‘
            startTimer(); 
        } else if (currentScreen === 'review') {
            renderReviewScreen();
        }
    }

    // í™ˆ í™”ë©´ ë Œë”ë§
    function renderHomeScreen() {
        const totalProblems = quizCycle.length;
        // í€´ì¦ˆê°€ ì™„ë£Œë˜ë©´ currentQuizIndexëŠ” quizCycle.lengthì™€ ê°™ì•„ì§
        const problemsCompleted = currentQuizIndex > -1 ? currentQuizIndex : 0; 
        
        const html = `
            <div class="flex flex-col items-center justify-center h-full text-center">
                <div class="text-6xl mb-6">ğŸ“š</div>
                <h2 class="text-3xl font-bold text-gray-800 mb-8">ì´ ${totalProblems}ë¬¸ì œ ë‹¨ì–´ í•™ìŠµì„ ì‹œì‘í•´ë³¼ê¹Œìš”?</h2>
                
                <p class="text-xl font-bold text-primary mb-6">
                    <span class="text-secondary">${problemsCompleted}</span> / ${totalProblems} ë¬¸ì œ ì§„í–‰
                </p>

                <!-- í€´ì¦ˆ ì‹œì‘ ë²„íŠ¼ -->
                <button onclick="startQuiz()" class="btn-large bg-secondary text-white w-full max-w-xs mb-4 shadow-xl hover:bg-emerald-600 transition-colors">
                    ${problemsCompleted === 0 ? 'í€´ì¦ˆ ì‹œì‘!' : 'í€´ì¦ˆ ì´ì–´í•˜ê¸°'}
                </button>
                
                <!-- ì ìˆ˜ ì´ˆê¸°í™” ë²„íŠ¼ -->
                <button onclick="showResetConfirmation()" class="text-primary text-sm font-semibold hover:text-indigo-600 mt-4 p-2 rounded-lg transition-colors">
                    ì ìˆ˜/í€´ì¦ˆ ì´ˆê¸°í™” (ë‹¤ì‹œ ì‹œì‘)
                </button>
            </div>
        `;
        contentArea.innerHTML = html;
    }
    
    // ì ìˆ˜ ì´ˆê¸°í™” ì‹¤í–‰
    function resetScore() {
        score = 0;
        saveScore();
        resetQuizCycle(); // í€´ì¦ˆ ì‚¬ì´í´ ë° ì˜¤ë‹µ ë…¸íŠ¸ ì´ˆê¸°í™”
        
        // ì´ˆê¸°í™” ì™„ë£Œ í”¼ë“œë°±
        const card = document.getElementById('feedback-card');
        card.innerHTML = `
            <div class="text-6xl mb-4">ğŸ‰</div>
            <h2 class="text-3xl font-bold mb-2 text-secondary">ì´ˆê¸°í™” ì™„ë£Œ!</h2>
            <p class="text-lg text-gray-600 mb-6">ì ìˆ˜ì™€ í€´ì¦ˆê°€ ë¦¬ì…‹ë˜ì—ˆìŠµë‹ˆë‹¤. ë‹¤ì‹œ ì‹œì‘í•  ì¤€ë¹„ê°€ ë˜ì—ˆì–´ìš”.</p>
            <button onclick="hideModalAndContinue(true)" class="btn-large bg-primary text-white w-full shadow-lg hover:bg-indigo-600">
                í™ˆìœ¼ë¡œ
            </button>
        `;

        feedbackModal.classList.remove('hidden', 'opacity-0');
        feedbackModal.classList.add('flex', 'opacity-100');
        setTimeout(() => {
            card.classList.remove('opacity-0', 'scale-95');
            card.classList.add('opacity-100', 'scale-100');
        }, 10);
    }

    // í€´ì¦ˆ í™”ë©´ ë Œë”ë§
    function renderQuizScreen() {
        if (!currentQuiz) {
            startQuiz(); 
            return;
        }

        const quiz = currentQuiz;
        let optionsHtml = '';
        
        // ì˜µì…˜ ë²„íŠ¼ì— ì„¸ë¡œ ê³µê°„ì„ íš¨ìœ¨ì ìœ¼ë¡œ ì‚¬ìš©í•˜ë„ë¡ mb-3ë¡œ ì¡°ì •
        quiz.options.forEach((option, index) => {
            const buttonText = option;
            const buttonColor = index % 2 === 0 ? 'bg-accent hover:bg-amber-500' : 'bg-secondary hover:bg-emerald-600';
            
            // checkAnswer í•¨ìˆ˜ë§Œ í˜¸ì¶œ
            optionsHtml += `
                <button onclick="checkAnswer('${option.replace(/'/g, "\\'")}')" 
                        class="btn-large ${buttonColor} text-white w-full shadow-lg text-left px-6">
                    ${buttonText}
                </button>
            `;
        });
        
        const questionText = quiz.question; 

        const html = `
            <!-- flex-col h-fullë¡œ ì „ì²´ ì˜ì—­ ì‚¬ìš© -->
            <div class="flex flex-col h-full">
                <!-- íƒ€ì´ë¨¸ í‘œì‹œ ì˜ì—­ -->
                <div class="w-full mb-2">
                    <!-- ë‚¨ì€ ì‹œê°„ í…ìŠ¤íŠ¸ (text-sm) -->
                    <div id="timer-display" class="text-center text-sm text-gray-700 font-medium mb-1">
                        ë‚¨ì€ ì‹œê°„: ${timeLeft}ì´ˆ
                    </div>
                    <!-- íƒ€ì´ë¨¸ ì§„í–‰ ë°” -->
                    <div class="w-full bg-gray-200 rounded-full overflow-hidden">
                        <div id="timer-bar" class="h-1.5 bg-incorrect" style="width: 100%; transition: width 0s linear;"></div>
                    </div>
                </div>


                <!-- ë¬¸ì œ ìœ í˜• ì•ˆë‚´ -->
                <div class="text-center mb-3">
                    <span class="inline-block px-3 py-1 bg-primary text-white text-xs font-semibold rounded-full shadow-md">
                        ${quiz.label}
                    </span>
                    <p class="text-xs text-gray-500 mt-1">ì§„í–‰ ìƒí™©: ${currentQuizIndex + 1} / ${quizCycle.length} ë¬¸ì œ</p>
                </div>

                <!-- ë¬¸ì œ ì˜ì—­: í…ìŠ¤íŠ¸ í¬ê¸°ë¥¼ 4xlì—ì„œ question-text (2.5rem)ë¡œ ì¶•ì†Œ -->
                <div class="p-4 bg-white rounded-xl shadow-lg mb-3 text-center border-4 border-accent flex-shrink-0">
                    <!-- ë¬¸ì œ(í•œê¸€ ë˜ëŠ” ì˜ì–´ ë‹¨ì–´)ë¥¼ í¬ê²Œ í‘œì‹œ -->
                    <p class="question-text font-extrabold text-primary">${questionText}</p>
                </div>
                
                <!-- ì„ íƒì§€ ì˜ì—­: ë‚¨ì€ ê³µê°„ ìµœëŒ€í•œ í™œìš© ë° ê°„ê²© ì¡°ì • -->
                <div class="option-button-container">
                    ${optionsHtml}
                </div>
                
                <!-- í•˜ë‹¨ ë²„íŠ¼ -->
                <button onclick="stopTimer(); currentScreen = 'home'; render();" class="mt-2 text-gray-500 text-sm hover:text-gray-700 transition-colors flex-shrink-0">
                    ğŸ¡ í™ˆ í™”ë©´ìœ¼ë¡œ ëŒì•„ê°€ê¸° (ì§„í–‰ ìƒí™© ì €ì¥ë¨)
                </button>
            </div>
        `;
        contentArea.innerHTML = html;
    }
    
    // ì˜¤ë‹µ ë…¸íŠ¸ í™”ë©´ ë Œë”ë§
    function renderReviewScreen() {
        stopTimer(); // í€´ì¦ˆê°€ ëë‚¬ìœ¼ë¯€ë¡œ íƒ€ì´ë¨¸ ì •ì§€
        currentScreen = 'review';
        
        let reviewHtml = '';
        
        if (incorrectlyAnswered.length === 0) {
            reviewHtml = `<div class="text-center py-10">
                <div class="text-6xl mb-4">ğŸ’¯</div>
                <h3 class="text-2xl font-bold text-secondary mb-4">í¼í™íŠ¸! ëª¨ë“  ë¬¸ì œë¥¼ ë§íˆì…¨ìŠµë‹ˆë‹¤!</h3>
                <p class="text-lg text-gray-600">ì´ ${quizCycle.length}ë¬¸ì œ ì¤‘ í‹€ë¦° ë¬¸ì œê°€ ì—†ìŠµë‹ˆë‹¤. ë‹¤ìŒ ì‚¬ì´í´ì— ë„ì „í•˜ì„¸ìš”!</p>
            </div>`;
        } else {
            // ì˜¤ë‹µ ë…¸íŠ¸ ë¦¬ìŠ¤íŠ¸ í•­ëª©ì˜ ê¸€ì í¬ê¸°ë¥¼ ì¡°ì •í•˜ì—¬ í•œ í™”ë©´ì— ë” ë§ì´ ë³´ì´ê²Œ í•¨
            const listItems = incorrectlyAnswered.map(pair => `
                <li class="flex flex-col sm:flex-row justify-between items-start sm:items-center py-2 px-3 border-b border-gray-200">
                    <span class="text-gray-900 font-semibold text-base w-1/3">${pair.korean}</span>
                    <span class="text-primary font-mono text-sm w-2/3 text-right">${pair.english}</span>
                </li>
            `).join('');
            
            reviewHtml = `
                <h2 class="text-2xl font-bold text-primary mb-4 text-center">ì˜¤ë‹µ ë…¸íŠ¸ ğŸ“</h2>
                <p class="text-center text-sm text-gray-700 mb-4">ì´ë²ˆ ${quizCycle.length}ë¬¸ì œ ì‚¬ì´í´ì—ì„œ í‹€ë¦° ë‹¨ì–´ ëª©ë¡ì…ë‹ˆë‹¤. (${incorrectlyAnswered.length}ê°œ)</p>
                <ul class="bg-gray-50 rounded-xl shadow-inner divide-y divide-gray-200">
                    ${listItems}
                </ul>
            `;
        }
        
        contentArea.innerHTML = `
            <div class="flex flex-col h-full">
                <!-- ì˜¤ë‹µ ë…¸íŠ¸ ë‚´ìš©: ìŠ¤í¬ë¡¤ì´ í•„ìš”í•  ê²½ìš°ë§Œ ìŠ¤í¬ë¡¤ë˜ë„ë¡ -->
                <div class="flex-grow overflow-y-auto">
                    ${reviewHtml}
                </div>
                
                <div class="mt-4 pt-4 border-t border-gray-200 flex-shrink-0">
                    <h3 class="text-lg font-bold text-gray-800 text-center mb-4">
                        ìµœì¢… ì ìˆ˜: <span class="text-secondary font-extrabold">${score}</span>ì  / ${MAX_SCORE}ì 
                    </h3>
                    <button onclick="resetQuizCycle(); currentScreen = 'home'; render();" class="btn-large bg-primary text-white w-full shadow-lg hover:bg-indigo-600">
                        ìƒˆë¡œìš´ ${quizCycle.length}ë¬¸ì œ ì‚¬ì´í´ ì‹œì‘
                    </button>
                </div>
            </div>
        `;
    }

    // ============== í€´ì¦ˆ ë¡œì§ ë° ìƒíƒœ ì—…ë°ì´íŠ¸ ==============

    // í€´ì¦ˆ ìƒíƒœë¥¼ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì§„í–‰ (ë‹¤ìŒ ë¬¸ì œ ë¡œë“œ ë˜ëŠ” ë¦¬ë·° í™”ë©´ìœ¼ë¡œ ì´ë™)
    function advanceToNextQuiz() {
        // ë‹¤ìŒ í€´ì¦ˆ ì¸ë±ìŠ¤ë¡œ ì´ë™
        currentQuizIndex++;

        if (currentQuizIndex < quizCycle.length) {
            // ë‹¤ìŒ ë¬¸ì œê°€ ìˆìœ¼ë©´ ë¡œë“œ
            currentQuiz = quizCycle[currentQuizIndex];
            currentScreen = 'quiz'; // í€´ì¦ˆ í™”ë©´ìœ¼ë¡œ ì „í™˜
            render(); // render()ì—ì„œ ìë™ìœ¼ë¡œ íƒ€ì´ë¨¸ ì‹œì‘
        } else {
            // ì‚¬ì´í´ ì™„ë£Œ!
            renderReviewScreen(); 
        }
    }


    // í€´ì¦ˆ ì‹œì‘ ë° ì²« ë¬¸ì œ ë¡œë“œ
    function startQuiz() {
        // Tone.js ì˜¤ë””ì˜¤ ì»¨í…ìŠ¤íŠ¸ ì‹œì‘ (ì‚¬ìš©ì ìƒí˜¸ì‘ìš© í•„ìš”)
        if (Tone.context.state !== 'running') {
             Tone.start().then(() => console.log("AudioContext started."));
        }

        if (VOCAB.length * 2 < quizCycle.length || VOCAB.length < QUIZ_OPTIONS_COUNT) {
            showSimpleMessage('ë‹¨ì–´ ë¶€ì¡±', 'í€´ì¦ˆë¥¼ ì‹œì‘í•˜ë ¤ë©´ ìµœì†Œ 4ê°œ ì´ìƒì˜ ë‹¨ì–´ê°€ í•„ìš”í•©ë‹ˆë‹¤.');
            return;
        }

        // ì „ì²´ ë¬¸ì œ ìˆ˜ ê³„ì‚°
        const totalProblems = VOCAB.length * 2;
        
        // í€´ì¦ˆ ì‚¬ì´í´ì´ ì™„ì„±ë˜ì§€ ì•Šì•˜ê±°ë‚˜, ì „ì²´ ë¬¸ì œ ìˆ˜ê°€ ë³€ê²½ë˜ì—ˆìœ¼ë©´ ì¬ì„¤ì •
        if (quizCycle.length !== totalProblems) {
            resetQuizCycle();
        }

        // ë§ˆì§€ë§‰ ë¬¸ì œê¹Œì§€ í’€ê³  ë„˜ì–´ê°„ ìƒíƒœë¼ë©´ ë¦¬ë·° í™”ë©´ìœ¼ë¡œ ì´ë™
        if (currentQuizIndex >= quizCycle.length -1) {
            renderReviewScreen();
            return;
        }
        
        // í€´ì¦ˆê°€ ì‹œì‘ë˜ì§€ ì•Šì•˜ê±°ë‚˜ ì™„ë£Œ í›„ ì¬ê°œí•˜ëŠ” ê²½ìš°
        if (currentQuizIndex === -1) {
             resetQuizCycle();
             currentQuizIndex = 0;
        }
        
        currentQuiz = quizCycle[currentQuizIndex];
        currentScreen = 'quiz';
        render();
    }
    
    // ì •ë‹µ í™•ì¸
    function checkAnswer(selectedOption) {
        // quizActiveê°€ falseì´ë©´ (ì´ë¯¸ ë‹µë³€í–ˆê±°ë‚˜ ì‹œê°„ ì´ˆê³¼) ì¶”ê°€ ë‹µë³€ ë¬´ì‹œ
        if (!currentQuiz || !quizActive) return; 

        stopTimer(); // íƒ€ì´ë¨¸ë¥¼ ë©ˆì¶”ê³  quizActiveë¥¼ falseë¡œ ì„¤ì •í•©ë‹ˆë‹¤.
        
        const isCorrect = selectedOption === currentQuiz.answer;
        
        if (isCorrect) {
            playCorrectSound(); // ì •ë‹µ ì‚¬ìš´ë“œ ì¬ìƒ
            score += 10; // ì ìˆ˜ ë¶€ì—¬
            saveScore();
            // ì •ë‹µì¼ ê²½ìš°: í”¼ë“œë°± ëª¨ë‹¬ ì—†ì´ ë°”ë¡œ ë‹¤ìŒ ë¬¸ì œë¡œ ì „í™˜
            advanceToNextQuiz();
        } else {
            playIncorrectSound(); // ì˜¤ë‹µ ì‚¬ìš´ë“œ ì¬ìƒ
            // ì˜¤ë‹µì¼ ê²½ìš°: í”¼ë“œë°± ëª¨ë‹¬ í‘œì‹œ
            recordIncorrectAnswer(currentQuiz.wordPair);
            showFeedback(false);
        }
    }
    
    // í”¼ë“œë°± ëª¨ë‹¬ í‘œì‹œ (ì˜¤ë‹µ ë˜ëŠ” ì‹œê°„ ì´ˆê³¼ ì‹œì—ë§Œ ì‚¬ìš©)
    function showFeedback(isCorrect, isTimeOut = false) {
        const quiz = currentQuiz;
        const correctValue = quiz.answer; 
        
        let title, message, icon;
        
        // ì˜¤ë‹µ ë…¸íŠ¸ì— ê¸°ë¡í•  ì›ë³¸ ë‹¨ì–´ ìŒì„ ì‚¬ìš©
        const koreanWord = quiz.wordPair.korean;
        const englishWord = quiz.wordPair.english;

        if (isTimeOut) {
            // ì‹œê°„ ì´ˆê³¼
            icon = 'ğŸš¨';
            title = 'ì‹œê°„ ì´ˆê³¼! ì˜¤ë‹µ ì²˜ë¦¬ë©ë‹ˆë‹¤.';
            message = `ì•„ì‰½ì§€ë§Œ ì‹œê°„ì„ ì´ˆê³¼í–ˆì–´ìš”. ì •ë‹µì€ '${koreanWord}'ì— í•´ë‹¹í•˜ëŠ” '${englishWord}'ì…ë‹ˆë‹¤.`;
        } else if (isCorrect) {
            // ì •ë‹µ (ì´ ì½”ë“œëŠ” ì •ë‹µ ì‹œ ë°”ë¡œ ë‹¤ìŒ ë¬¸ì œë¡œ ë„˜ì–´ê°€ë¯€ë¡œ ê±°ì˜ ì‹¤í–‰ë˜ì§€ ì•ŠìŒ)
            icon = 'âœ…';
            title = 'ì •ë‹µ! ì§ì§ì§!';
            message = `ì˜í–ˆì–´ìš”! ì •ë‹µì€ '${correctValue}'ì…ë‹ˆë‹¤!`;
        } else {
            // ì˜¤ë‹µ
            icon = 'âŒ';
            title = 'ì•„ì‰½ì§€ë§Œ... ì˜¤ë‹µ!';
            message = `ì •ë‹µì€ '${koreanWord}'ì— í•´ë‹¹í•˜ëŠ” '${englishWord}'ì…ë‹ˆë‹¤.`;
        }

        document.getElementById('feedback-card').innerHTML = `
            <div id="feedback-icon" class="text-6xl mb-4">${icon}</div>
            <h2 id="feedback-title" class="text-2xl font-bold mb-2 ${isCorrect && !isTimeOut ? 'text-correct' : 'text-incorrect'}">
                ${title}
            </h2>
            <p id="feedback-message" class="text-base text-gray-600 mb-5">
                ${message}
            </p>
            <button onclick="hideModalAndContinue()" class="btn-large bg-primary text-white w-full shadow-lg hover:bg-indigo-600">
                ë‹¤ìŒ ë¬¸ì œ!
            </button>
        `;

        feedbackModal.classList.remove('hidden', 'opacity-0');
        feedbackModal.classList.add('flex', 'opacity-100');
        setTimeout(() => {
            feedbackCard.classList.remove('opacity-0', 'scale-95');
            feedbackCard.classList.add('opacity-100', 'scale-100');
        }, 10);
    }

    // ëª¨ë‹¬ ìˆ¨ê¸°ê³  ë‹¤ìŒ í€´ì¦ˆ ì§„í–‰ ë˜ëŠ” í™ˆìœ¼ë¡œ ì´ë™
    function hideModalAndContinue(toHome = false) {
        // ì• ë‹ˆë©”ì´ì…˜ì„ ìœ„í•œ í´ë˜ìŠ¤ ì œê±°
        feedbackCard.classList.remove('opacity-100', 'scale-100');
        feedbackCard.classList.add('opacity-0', 'scale-95');
        
        setTimeout(() => {
            feedbackModal.classList.remove('flex', 'opacity-100');
            feedbackModal.classList.add('hidden', 'opacity-0');
            
            if (toHome) {
                currentScreen = 'home';
                render();
                return;
            }

            // ì˜¤ë‹µ/ì‹œê°„ ì´ˆê³¼ í›„ í™•ì¸ ë²„íŠ¼ì„ ëˆŒë €ìœ¼ë¯€ë¡œ ë‹¤ìŒ ë¬¸ì œë¡œ ì§„í–‰
            advanceToNextQuiz();

        }, 300); 
    }
    
    // ì ìˆ˜ ì´ˆê¸°í™” í™•ì¸ ëª¨ë‹¬ í‘œì‹œ
    function showResetConfirmation() {
        stopTimer(); 
        
        const card = document.getElementById('feedback-card');
        card.innerHTML = `
            <div class="text-6xl mb-4">âš ï¸</div>
            <h2 class="text-2xl font-bold mb-2 text-red-500">ì ìˆ˜/í€´ì¦ˆ ì´ˆê¸°í™” í™•ì¸</h2>
            <p class="text-base text-gray-600 mb-5">ì •ë§ë¡œ ì ìˆ˜ì™€ í€´ì¦ˆ ì§„í–‰ ìƒí™©ì„ ë¦¬ì…‹í•˜ì‹œê² ì–´ìš”? ì´ ì‘ì—…ì€ ë˜ëŒë¦´ ìˆ˜ ì—†ìŠµë‹ˆë‹¤.</p>
            <div class="flex justify-between space-x-4">
                <button onclick="hideModalAndContinue(true)" class="btn-large flex-1 bg-gray-300 text-gray-800 shadow-md hover:bg-gray-400">
                    ì·¨ì†Œ
                </button>
                <button onclick="resetScore()" class="btn-large flex-1 bg-incorrect text-white shadow-md hover:bg-red-600">
                    ì´ˆê¸°í™”!
                </button>
            </div>
        `;

        feedbackModal.classList.remove('hidden', 'opacity-0');
        feedbackModal.classList.add('flex', 'opacity-100');
        setTimeout(() => {
            card.classList.remove('opacity-0', 'scale-95');
            card.classList.add('opacity-100', 'scale-100');
        }, 10);
    }
    
    // ê°„ë‹¨í•œ ë©”ì‹œì§€ ëª¨ë‹¬ (ì£¼ë¡œ ì—ëŸ¬ë‚˜ ì•Œë¦¼ìš©)
    function showSimpleMessage(title, message, toHome = true) {
        stopTimer(); 
        
        const card = document.getElementById('feedback-card');
        card.innerHTML = `
            <div class="text-6xl mb-4">ğŸ’¡</div>
            <h2 class="text-2xl font-bold mb-2 text-primary">${title}</h2>
            <p class="text-base text-gray-600 mb-5">${message}</p>
            <button onclick="hideModalAndContinue(${toHome})" class="btn-large bg-primary text-white w-full shadow-lg hover:bg-indigo-600">
                í™•ì¸
            </button>
        `;

        feedbackModal.classList.remove('hidden', 'opacity-0');
        feedbackModal.classList.add('flex', 'opacity-100');
        setTimeout(() => {
            card.classList.remove('opacity-0', 'scale-95');
            card.classList.add('opacity-100', 'scale-100');
        }, 10);
    }


    // ì•± ì‹œì‘
    window.onload = initApp;

</script>

</body>
</html>
